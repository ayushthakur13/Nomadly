<section class="tab-content" id="memories">
    <div class="trip-cover-container">
        <div class="trip-cover-wrapper">
            <img
                src="{{trip.imageUrl}}"
                alt="Trip Cover"
                class="trip-cover-img"
            />

            {{#if isOwner}}
            <div class="trip-cover-actions">
                <form class="update-trip-cover-form" enctype="multipart/form-data">
                    <label class="cover-upload-label" for="coverImageInput">
                        <span class="upload-icon">üì∏</span> Change Cover
                    </label>
                    <input type="file" name="image" id="coverImageInput" accept="image/*" hidden />
                </form>

                <form class="delete-trip-cover-form">
                    <button type="submit" class="delete-cover-btn">üóëÔ∏è Remove</button>
                </form>
            </div>
            {{/if}}
        </div>
    </div>

    <div class="memories-content">
        <div class="memories-header">
            <h3>üì∑ Trip Memories</h3>

            <form class="add-memory-form" enctype="multipart/form-data">
                <label class="memory-image-label">
                    Add Photo
                    <input type="file" name="image" id="memoryImage" accept="image/*" hidden />
                </label>
                <input type="text" name="caption" placeholder="Add a caption (optional)" class="memory-caption-input" />
            </form>

        </div>

        <div class="memory-grid">
            {{#if trip.memories.length}}  
                {{#each trip.memories}}
                <div class="memory-card" data-memory-id="{{this._id}}">
                    <img src="{{this.url}}" alt="Memory Image" class="memory-img" loading="lazy" />
                    {{#if this.caption}}
                        <p class="memory-caption">‚Äú{{this.caption}}‚Äù</p>
                    {{/if}}
                    <p class="memory-uploader">‚Äî {{lookup ../userMap this.uploadedBy}}</p>

                    <div class="memory-btn">
                        <form class="download-memory-form">
                            <input type="hidden" name="memoryId" value="{{this._id}}" />
                            <button type="submit" class="memory-download-btn" title="Download">
                                <i class="fa-solid fa-file-arrow-down"></i>
                            </button>
                        </form>

                        <form class="delete-memory-form">
                            <input type="hidden" name="memoryId" value="{{this._id}}" />
                            <button type="submit" class="memory-delete-btn" title="Delete">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>
                    
                </div>
                {{/each}}
            {{else}}
                <p class="no-memory-message">No memories found for this trip yet.</p>
            {{/if}} 
        </div>

        <div id="pagination-container">
            {{#if pagination.showPagination}}
                <div id="pagination-controls" class="pagination-buttons">
                    <button id="prevBtn" class="pagination-btn">‚¨Ö Prev</button>
                    <span id="pageIndicator" class="page-indicator">Page {{pagination.currentPage}} of {{pagination.totalPages}}</span>
                    <button id="nextBtn" class="pagination-btn">Next ‚û°</button>
                    
                    <a href="/trips/{{trip._id}}/memories" class="pagination-btn view-all-btn">View All</a>
                </div>
            {{/if}}
        </div>
    </div>

</section>
