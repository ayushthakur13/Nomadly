<section class="tab-content" id="memories">
    <div class="trip-cover-container">
        <div class="trip-cover-wrapper">
            <img
                src="{{trip.imageUrl}}"
                alt="Trip Cover"
                class="trip-cover-img"
            />

            {{#if isOwner}}
            <div class="trip-cover-actions">
                <form class="update-trip-cover-form" enctype="multipart/form-data">
                    <label class="cover-upload-label" for="coverImageInput">
                        <i class="fa-solid fa-camera"></i> Change Cover
                    </label>
                    <input type="file" name="image" id="coverImageInput" accept="image/*" hidden />
                </form>

                <form class="delete-trip-cover-form">
                    <button type="submit" class="delete-cover-btn">
                        <i class="fa-solid fa-trash"></i> Remove
                    </button>
                </form>
            </div>
            {{/if}}
        </div>
    </div>

    <div class="memories-content">
        <div class="memories-header">
            <h3>
                Trip Memories 
                <span id="memoryCount" class="memory-count"></span>
            </h3>

            <div class="memory-actions">
                <form class="add-memory-form" enctype="multipart/form-data">
                    <label class="memory-image-label">
                        Add Photo
                        <input type="file" name="image" id="memoryImage" accept="image/*" hidden />
                    </label>
                </form>

                <button id="downloadAllBtn" title="Download All Memories">
                    <i class="fa-solid fa-download"></i> All
                </button>

                {{#if isOwner}}
                    <button id="deleteAllBtn" title="Delete All Memories">
                        <i class="fa-solid fa-trash"></i> All
                    </button>
                {{/if}}
            </div>
        </div>

        <div class="memory-grid">
            {{#if trip.memories.length}}  
                {{#each trip.memories}}
                <div class="memory-card" data-memory-id="{{this._id}}">
                    <img src="{{this.url}}" alt="Memory Image" class="memory-img" loading="lazy" />
                    <p class="memory-uploader">— {{lookup ../userMap this.uploadedBy}}</p>

                    <div class="memory-btn">
                        <button type="button" class="memory-download-btn" title="Download" data-url="{{this.url}}">
                            <i class="fa-solid fa-file-arrow-down"></i>
                        </button>

                        <form class="delete-memory-form">
                            <input type="hidden" name="memoryId" value="{{this._id}}" />
                            <button type="submit" class="memory-delete-btn" title="Delete">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>
                    
                </div>
                {{/each}}
            {{else}}
                <p class="no-memory-message">No memories found for this trip yet.</p>
            {{/if}} 
        </div>

        <div id="pagination-container">
            {{#if pagination.showPagination}}
                <div id="pagination-controls" class="pagination-buttons">
                    <button id="prevBtn" class="pagination-btn">⬅ Prev</button>
                    <span id="pageIndicator" class="page-indicator">Page {{pagination.currentPage}} of {{pagination.totalPages}}</span>
                    <button id="nextBtn" class="pagination-btn">Next ➡</button>
                    
                    <a href="/trips/{{trip._id}}/memories" class="pagination-btn view-all-btn">View All</a>
                </div>
            {{/if}}
        </div>
    </div>

</section>
